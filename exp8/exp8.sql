CREATE TABLE ACTOR (
    Act_id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    Act_Name VARCHAR(50) NOT NULL,
    Act_Gender VARCHAR(50) NOT NULL
);

CREATE TABLE DIRECTOR (
    Dir_id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    Dir_Name VARCHAR(50) NOT NULL,
    Dir_Phone VARCHAR(50) NOT NULL
);

CREATE TABLE MOVIES (
    Mov_id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    Mov_Title VARCHAR(50) NOT NULL,
    Mov_Year INT NOT NULL,
    Mov_Lang VARCHAR(50) NOT NULL,
    Dir_id INT NOT NULL,
    FOREIGN KEY (Dir_id) REFERENCES DIRECTOR(Dir_id)
);

CREATE TABLE MOVIE_CAST (
    Act_id INT NOT NULL,
    Mov_id INT NOT NULL,
    Role VARCHAR(50) NOT NULL,
    PRIMARY KEY (Act_id, Mov_id),
    FOREIGN KEY (Act_id) REFERENCES ACTOR(Act_id),
    FOREIGN KEY (Mov_id) REFERENCES MOVIES(Mov_id)
);

CREATE TABLE RATING (
    Mov_id INT NOT NULL,
    Rev_Stars INT NOT NULL,
    PRIMARY KEY (Mov_id),
    FOREIGN KEY (Mov_id) REFERENCES MOVIES(Mov_id)
);



INSERT INTO ACTOR VALUES (301, 'ANUSHKA', 'F');
INSERT INTO ACTOR VALUES (302, 'PRABHAS', 'M');
INSERT INTO ACTOR VALUES (303, 'PUNITH', 'M');
INSERT INTO ACTOR VALUES (304, 'JERMY', 'M');
INSERT INTO DIRECTOR VALUES (60, 'RAJAMOULI', 8751611001);
INSERT INTO DIRECTOR VALUES (61, 'HITCHCOCK', 7766138911);
INSERT INTO DIRECTOR VALUES (62, 'FARAN', 9986776531);
INSERT INTO DIRECTOR VALUES (63, 'STEVEN SPIELBERG', 8989776530);
INSERT INTO MOVIES VALUES (1001, 'BAHUBALI-2', 2017, 'TELAGU', 60);
INSERT INTO MOVIES VALUES (1002, 'BAHUBALI-1', 2015, 'TELAGU', 60);
INSERT INTO MOVIES VALUES (1003, 'AKASH', 2008, 'KANNADA', 61);
INSERT INTO MOVIES VALUES (1004, 'WAR HORSE', 2011, 'ENGLISH', 63);
INSERT INTO MOVIE_CAST VALUES (301, 1002, 'HEROINE');
INSERT INTO MOVIE_CAST VALUES (301, 1001, 'HEROINE');
INSERT INTO MOVIE_CAST VALUES (303, 1003, 'HERO');
INSERT INTO MOVIE_CAST VALUES (303, 1002, 'GUEST');
INSERT INTO MOVIE_CAST VALUES (304, 1004, 'HERO');
INSERT INTO RATING VALUES (1001, 4);
INSERT INTO RATING VALUES (1002, 2);
INSERT INTO RATING VALUES (1003, 5);
INSERT INTO RATING VALUES (1004, 4);


SELECT Mov_title 
FROM MOVIES 
WHERE Dir_id IN (SELECT Dir_id FROM DIRECTOR WHERE Dir_Name = 'Hitchcock');

SELECT DISTINCT Mov_Title 
FROM MOVIES 
WHERE Mov_id IN (SELECT Mov_id FROM MOVIE_CAST GROUP BY Act_id HAVING COUNT(*) > 1);

SELECT Act_Name 
FROM ACTOR 
INNER JOIN MOVIE_CAST ON ACTOR.Act_id = MOVIE_CAST.Act_id 
INNER JOIN MOVIES ON MOVIE_CAST.Mov_id = MOVIES.Mov_id 
WHERE Mov_Year < 2000 OR Mov_Year > 2015;

SELECT Mov_Title, MAX(Rev_Stars) 
FROM MOVIES 
INNER JOIN RATING ON MOVIES.Mov_id = RATING.Mov_id 
GROUP BY Mov_Title 
ORDER BY Mov_Title;

UPDATE RATING 
SET Rev_Stars = 5 
WHERE Mov_id IN 
(SELECT Mov_id FROM MOVIES 
WHERE Dir_id IN (SELECT Dir_id FROM DIRECTOR WHERE Dir_Name = 'Steven Spielberg'));